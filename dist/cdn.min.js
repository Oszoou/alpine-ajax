(()=>{var h={headers:{},mergeStrategy:"replace",transitions:!1,mapDelimiter:":"},F=()=>{console.error(`You can't use the "morph" merge without first installing the Alpine "morph" plugin here: https://alpinejs.dev/plugins/morph`)};function b(e){e.morph&&(F=e.morph),e.addInitSelector(()=>`[${e.prefixed("target")}]`),e.addInitSelector(()=>`[${e.prefixed("target\\.push")}]`),e.addInitSelector(()=>`[${e.prefixed("target\\.replace")}]`),e.directive("target",(r,{value:n,modifiers:i,expression:s},{evaluateLater:a,effect:o})=>{let l=c=>{r._ajax_target=r._ajax_target||{};let w={ids:C(r,c),sync:!0,focus:!i.includes("nofocus"),history:i.includes("push")?"push":i.includes("replace")?"replace":!1},m=i.filter(f=>["back","away","error"].includes(f)||parseInt(f));m=m.length?m:["xxx"],m.forEach(f=>{f.charAt(0)==="3"&&(f="3xx"),r._ajax_target[f]=w})};if(n==="dynamic"){let c=a(s);o(()=>c(l))}else l(s)}),e.directive("headers",(r,{expression:n},{evaluateLater:i,effect:s})=>{let a=i(n||"{}");s(()=>{a(o=>{r._ajax_headers=o})})}),e.addInitSelector(()=>`[${e.prefixed("merge")}]`),e.directive("merge",(r,{value:n,modifiers:i,expression:s},{evaluateLater:a,effect:o})=>{let l=c=>{r._ajax_strategy=c,r._ajax_transition=h.transitions||i.includes("transition")};if(n==="dynamic"){let c=a(s);o(()=>c(l))}else l(s)}),e.magic("ajax",r=>async(n,i={})=>{let s={el:r,target:{xxx:{ids:C(r,i.targets||i.target),sync:!!i.sync,history:"history"in i?i.history:!1,focus:"focus"in i?i.focus:!0}},headers:i.headers||{}},a=i.method?i.method.toUpperCase():"GET",o=i.body;return A(s,n,a,o)});let t=!1;e.ajax={start(){t||(document.addEventListener("submit",D),document.addEventListener("click",T),window.addEventListener("popstate",k),t=!0)},stop(){document.removeEventListener("submit",D),document.removeEventListener("click",T),window.removeEventListener("popstate",k),t=!1},configure(r){h=Object.assign(h,r)}},e.ajax.start()}b.configure=e=>(h=Object.assign(h,e),b);var $=b;function k(e){!e.state||!e.state.__ajax||window.location.reload(!0)}async function T(e){if(e.defaultPrevented||e.which>1||e.altKey||e.ctrlKey||e.metaKey||e.shiftKey)return;let t=e?.target.closest("a[href]:not([download]):not([noajax])");if(!t||!t._ajax_target||t.isContentEditable||t.origin!==window.location.origin||t.getAttribute("href").startsWith("#")||t.hash&&M(t,new URL(document.baseURI)))return;e.preventDefault(),e.stopImmediatePropagation();let r={el:t,target:t._ajax_target,headers:t._ajax_headers||{}},n=t.getAttribute("href");try{return await A(r,n)}catch(i){if(i.name==="RenderError"){console.warn(i.message),window.location.href=t.href;return}throw i}}async function D(e){if(e.defaultPrevented)return;let t=e.target,r=e.submitter,n=(r?.getAttribute("formmethod")||t.getAttribute("method")||"GET").toUpperCase();if(!t||!t._ajax_target||n==="DIALOG"||r?.hasAttribute("formnoajax")||r?.hasAttribute("formtarget")||t.hasAttribute("noajax")||t.hasAttribute("target"))return;e.preventDefault(),e.stopImmediatePropagation();let i={el:t,target:t._ajax_target,headers:t._ajax_headers||{}},s=new FormData(t),a=t.getAttribute("enctype"),o=t.getAttribute("action");r&&(a=r.getAttribute("formenctype")||a,o=r.getAttribute("formaction")||o,r.name&&s.append(r.name,r.value));try{return await G(r,()=>A(i,o,n,s,a))}catch(l){if(l.name==="RenderError"){console.warn(l.message),t.setAttribute("noajax","true"),t.requestSubmit(r);return}throw l}}async function G(e,t){if(!e)return await t();let r=i=>i.preventDefault();e.setAttribute("aria-disabled","true"),e.addEventListener("click",r);let n;try{n=await t()}finally{e.removeAttribute("aria-disabled"),e.removeEventListener("click",r)}return n}var p={store:new Map,plan(e,t){if(e.ids.forEach(r=>{let n=r[0],i=["_self","_top","_none"].includes(n)?document.documentElement:document.getElementById(n);if(!i)return console.warn(`Target [#${n}] was not found in current document.`);i._ajax_id=r[1],this.set(i,t)}),e.sync){let r=e.ids.flat();document.querySelectorAll("[x-sync]").forEach(n=>{let i=n.getAttribute("id");if(!i)throw new j(n);r.includes(i)||(n._ajax_id=i,n._ajax_sync=!0,this.set(n,t))})}},purge(e){this.store.forEach((t,r)=>e===t&&this.delete(r))},get(e){let t=[];return this.store.forEach((r,n)=>e===r&&t.push(n)),t},set(e,t){e.querySelectorAll("[aria-busy]").forEach(r=>{this.delete(r)}),e.setAttribute("aria-busy","true"),this.store.set(e,t)},delete(e){e.removeAttribute("aria-busy"),this.store.delete(e)}},g=new Map;async function A(e,t="",r="GET",n=null,i="application/x-www-form-urlencoded"){if(!d(e.el,"ajax:before"))return;let s=e.target.xxx,a={ok:!1,redirected:!1,url:"",status:"",html:"",raw:""};p.plan(s,a);let o=new URL(e.el.closest("[data-source]")?.dataset.source||"",document.baseURI);t=new URL(t||o,document.baseURI),n&&(n=N(n),r==="GET"?(t.search=R(n).toString(),n=null):i!=="multipart/form-data"&&(n=R(n)));let l={action:t.toString(),method:r,body:n,enctype:i,referrer:o.toString(),headers:Object.assign({"X-Alpine-Request":!0,"X-Alpine-Target":p.get(a).map(u=>u._ajax_id).join(" ")},h.headers,e.headers)};d(e.el,"ajax:send",l);let c;if(l.method==="GET"&&g.has(l.action)?c=g.get(l.action):(c=fetch(l.action,l).then(async u=>{let x=await u.text(),_=document.createRange().createContextualFragment("<template>"+x+"</template>");return u.html=_.firstElementChild.content,u.raw=x,u}),g.set(l.action,c)),await c.then(u=>{a.ok=u.ok,a.redirected=u.redirected,a.url=u.url,a.status=u.status,a.html=u.html,a.raw=u.raw}),a.ok?(a.redirected&&(d(e.el,"ajax:redirect",a),g.set(a.url,c),setTimeout(()=>{g.delete(a.url)},5)),d(e.el,"ajax:success",a)):d(e.el,"ajax:error",a),d(e.el,"ajax:sent",a),g.delete(l.action),!a.html){p.purge(a);return}let w=a.redirected?"3xx":a.status.toString(),m=M(new URL(a.url),new URL(l.referrer,document.baseURI)),f=[a.redirected?m?"back":"away":null,w,w.charAt(0)+"xx",a.ok?"xxx":"error","xxx"].find(u=>u in e.target);f!=="xxx"&&(s=e.target[f],(!a.redirected||!m||!s.ids.flat().includes("_self"))&&(p.purge(a),p.plan(s,a))),s.history&&H(s.history,a.url);let y=!s.focus,O=p.get(a).map(async u=>{if(!u.isConnected||u._ajax_id==="_none")return;u===document.documentElement&&(window.location.href=a.url);let x=a.html.getElementById(u._ajax_id);if(!x){if(u._ajax_sync||!d(e.el,"ajax:missing",{target:u,response:a}))return;if(a.ok)return u.remove();throw new E(u,a.status)}let _=u._ajax_strategy||h.mergeStrategy,S=async()=>{if(u=await B(_,u,x),u){u.dataset.source=a.url,p.delete(u);let I=["[x-autofocus]","[autofocus]"];for(;!y&&I.length;){let L=I.shift();u.matches(L)&&(y=U(u)),y=y||Array.from(u.querySelectorAll(L)).some(q=>U(q))}}return d(u,"ajax:merged"),u};if(d(u,"ajax:merge",{strategy:_,content:x,merge:S}))return S()}),v=await Promise.all(O);return d(e.el,"ajax:after",{response:a,render:v}),v}function N(e){if(e instanceof FormData)return e;if(e instanceof HTMLFormElement)return new FormData(e);let t=new FormData;for(let r in e)typeof e[r]=="object"?t.append(r,JSON.stringify(e[r])):t.append(r,e[r]);return t}function R(e){let t=Array.from(e.entries()).filter(([r,n])=>!(n instanceof File));return new URLSearchParams(t)}async function B(e,t,r){let n={before(s,a){return s.before(...a.childNodes),s},replace(s,a){return s.replaceWith(a),a},update(s,a){return s.replaceChildren(...a.childNodes),s},prepend(s,a){return s.prepend(...a.childNodes),s},append(s,a){return s.append(...a.childNodes),s},after(s,a){return s.after(...a.childNodes),s},morph(s,a){return F(s,a),document.getElementById(a.getAttribute("id"))}};return!t._ajax_transition||!document.startViewTransition?n[e](t,r):(await document.startViewTransition(()=>(t=n[e](t,r),Promise.resolve())).updateCallbackDone,t)}function U(e){return!e||!e.getClientRects().length?!1:(setTimeout(()=>{e.hasAttribute("tabindex")||e.setAttribute("tabindex","0"),e.focus()},0),!0)}function H(e,t){return{push:()=>window.history.pushState({__ajax:!0},"",t),replace:()=>window.history.replaceState({__ajax:!0},"",t)}[e]()}function C(e,t=null){let r=e.getAttribute("id"),n=[r];if(t&&(n=Array.isArray(t)?t:t.split(" ")),n=n.filter(i=>i).map(i=>{let s=i.split(h.mapDelimiter).map(a=>a||r);return s[1]=s[1]||s[0],s}),n.length===0)throw new j(e);return n}function d(e,t,r){return e.dispatchEvent(new CustomEvent(t,{detail:r,bubbles:!0,composed:!0,cancelable:!0}))}function M(e,t){return P(e.pathname)===P(t.pathname)}function P(e){return e.replace(/\/$/,"")}var j=class extends DOMException{constructor(t){let r=(t.outerHTML.match(/<[^>]+>/)??[])[0]??"[Element]";super(`${r} is missing an ID to target.`,"IDError")}},E=class extends DOMException{constructor(t,r){let n=t.getAttribute("id");super(`Target [#${n}] was not found in response with status [${r}].`,"RenderError")}};document.addEventListener("alpine:initializing",()=>{$(window.Alpine)});})();
